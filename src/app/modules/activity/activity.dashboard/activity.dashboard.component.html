<div class="patientDashboard">

    <div class="container-fluid">

        <div class="row" style="padding: 0px 7px;">

            <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6 navigation"
                 style="padding: 0px 0px; z-index: 1099;">
                <i class="material-icons float-left" (click)="previosDay()" [title]="'ACTIVITY.PREVIOUS-DAY'|translate">keyboard_arrow_left</i>

                <i class="material-icons float-left" [ngClass]="isToday(currentDate)?'disabled':''" (click)="nextDay()"
                   [title]="'ACTIVITY.NEXT-DAY'|translate">keyboard_arrow_right</i>

                <label class="float-left">{{currentDate | date}}</label>

            </div>

            <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6 navigation"
                 style="padding: 0px 0px" *ngIf="patient && patient.external_services">

                <label style="position: absolute; right:5px;padding-right:10px;font-weight: normal; font-size: 12px">
                    {{'ACTIVITY.LAST-SYNC'|translate}}
                    : {{patient.external_services.fitbit_last_sync | date}}</label>
            </div>

        </div>

        <div class="row" style="padding-top: 0px;padding-left: 0px">
            <!-- Activities -->
            <div class="col-sm-12 col-md-4 col-lg-4 col-xl-4">
                <dashboard-card [title]="'ACTIVITY.RECENT-ACTIVITY'|translate"
                                [urlAction]="['/app/activities',patientId,'physical_activity']">
                    <div class="row physicalActivity" [title]="'ACTIVITY.VIEW-DETAILS'|translate"
                         *ngFor="let activity of listActivities;index as i;trackBy: trackById"
                         [routerLink]="['/app/activities',patientId,'physical_activity', activity.id]">
                        <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12" style="padding-left: 0px">
                            <label class="float-left"
                                   style="font-weight: normal;font-size: 20px">{{activity.name|physicalActivity|translate}}</label>
                            <i class="material-icons float-right">keyboard_arrow_right</i>
                            <small class="float-right">{{activity.start_time|date:'mediumDate'}}</small>
                        </div>

                        <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12"
                             style="padding: 0px 0px">

                            <div class="d-flex justify-content-around">
                                <label class="float-left">
                                    {{Math.floor(activity.duration / 60000)}}
                                    <small>min</small>
                                </label>


                                <label class="float-right">
                                    {{activity.calories}}
                                    <small>calls</small>
                                </label>

                                <label class="float-right">
                                    {{activity.heart_rate_average}}
                                    <small>avg bpm</small>
                                </label>
                            </div>

                        </div>

                        <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12"
                             style="padding: 0px 0px; margin: 0px 0px;">
                            <div class="echarts-div-graph" echarts [options]="activityGraph"
                                 style="padding: 0px 0px; margin: 0px 0px;border: 1px solid #c3c3c3"></div>
                        </div>

                    </div>

                    <div class="row justify-content-center" *ngIf="!listActivities.length && listActivitiesIsEmpty"
                         style="height: 620px;">
                        <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 row justify-content-center"
                             style="margin: 15px 15px; margin-top: 50px;max-width: 150px;max-height: 150px;border: 1px dashed black; border-radius: 70px">
                            <img src="../../../../assets/img/time-series/running-man.svg" width="80">
                        </div>
                        <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12" style="height: 300px">
                            <h3 class="text-center">{{'ACTIVITY.NO-RECENT-EXERCISES'|translate}}</h3>
                            <p class="text-center"
                               style="font-size: 16px">{{'ACTIVITY.NO-RECENT-EXERCISES-MESSAGE'|translate}}</p>
                        </div>


                    </div>

                    <div class="row justify-content-center" *ngIf="!listActivities.length && !listActivitiesIsEmpty"
                         style="height: 620px;">

                        <div class="divSpinner">
                            <spinner [title]="'ACTIVITY.SPINNER'|translate"
                                     [message]="'ACTIVITY.SPINNER'|translate"></spinner>
                        </div>

                    </div>

                </dashboard-card>

            </div>

            <div class="col-sm-12 col-md-8 col-lg col-xl patientDashboard"
                 style="padding: 0px 0px; padding-right: 7px">

                <div class="row" style="padding-top:7px">
                    <!-- Sleep -->
                    <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6" style="padding-top:0px;">
                        <dashboard-card [title]="'ACTIVITY.SLEEP.SLEEP'|translate"
                                        [urlAction]="['/app/activities',patientId,'sleep']"
                                        (mouseenter)="sleepEnterAndLeave(true)"
                                        (mouseleave)="sleepEnterAndLeave(false)">
                            <!--                                    <small style="position: absolute;right: 10px; top: 10px">12/12/2019</small>-->
                            <div class="row justify-content-center" *ngIf="sleepSelected && !loadingDashboard">

                                <div class="col justify-content-center" #sleepDiv
                                     style="height: 250px; padding: 0px 0px; display: flex; align-items: center; margin: auto; margin-top: 0px; border: 1px solid black">
                                    <ngx-gauge
                                            [size]="sleepSize"
                                            [type]="'semi'"
                                            [min]="0"
                                            [max]="sleepMax"
                                            [foregroundColor]="'#2B4A77'"
                                            [thick]="15"
                                            [value]="sleepHover?sleepValue:sleepMax"
                                            [duration]="500"
                                            [cap]="'round'"
                                            id="graphSleep">
                                        <ngx-gauge-label>

                                        </ngx-gauge-label>
                                        <ngx-gauge-value>

                                        </ngx-gauge-value>
                                    </ngx-gauge>
                                    <div style="position: absolute;display: flex;align-items: center;width:100%; height: 100%;justify-content: center;">
                                        <img src="../../../../assets/img/time-series/moon.svg" width="25%"
                                             style="margin-bottom: 60px">
                                    </div>
                                    <div style="position: absolute;top:35%;width: 85%">
                                        <div *ngIf="!sleepHover">
                                            <span class="float-left">{{sleepSelected.start_time|date:'shortTime'}}</span>
                                            <span class="float-right">{{sleepSelected.end_time|date:'shortTime'}}</span>
                                        </div>
                                        <div *ngIf="sleepHover">
                                            <span class="float-left">0h</span>
                                            <span class="float-right">{{Math.floor(goal.sleep / 60)}}h</span>
                                        </div>
                                    </div>
                                    <div style="position: absolute;bottom:15%;width: 85%; display: flex; align-items: center; justify-content: center">
                                        <label style="font-size: 35px">
                                            {{Math.floor((sleepSelected.duration / 3600000))}}
                                            <small>{{'HABITS.SLEEP.TIME-ABBREVIATION'|translate}}</small>
                                            {{Math.floor((sleepSelected.duration % 3600000) / 60000)}}
                                            <small>{{'HABITS.SLEEP.MINUTES-ABBREVIATION'|translate}}</small>
                                        </label>
                                    </div>
                                    <div class="text-center"
                                         style="position: absolute;bottom:0%;width: 85%; display: flex; align-items: center; justify-content: center">
                                        <label style="font-weight: normal; font-size:22px"
                                               *ngIf="!sleepHover">
                                            <span *ngIf="Math.floor((sleepSelected.pattern.summary.awake.duration / 3600000))">
                                                {{Math.floor((sleepSelected.pattern.summary.awake.duration / 3600000))}}
                                                {{'HABITS.SLEEP.TIME-ABBREVIATION'|translate}}
                                            </span>
                                            <span *ngIf="Math.floor((sleepSelected.pattern.summary.awake.duration % 3600000) / 60000)">
                                                {{Math.floor((sleepSelected.pattern.summary.awake.duration % 3600000) / 60000)}}
                                                {{'HABITS.SLEEP.MINUTES-ABBREVIATION'|translate}}
                                                {{'ACTIVITY.PIPES.SLEEP.AWAKE'|translate}}
                                            </span>
                                        </label>
                                        <label style="font-weight: normal; font-size:22px"
                                               *ngIf="sleepHover">
                                            {{
                                            Math.floor((goal.sleep - (sleepSelected.duration / 60000)) / 60) ?
                                                Math.floor((goal.sleep - (sleepSelected.duration / 60000)) / 60)
                                                + ('HABITS.SLEEP.TIME-ABBREVIATION'|translate) + ' ' + ('SHARED.AND'|translate)
                                                : ''
                                            }}
                                            {{Math.floor((goal.sleep - (sleepSelected.duration / 60000)) % 60)}}{{'HABITS.SLEEP.MINUTES-ABBREVIATION'|translate}}
                                            {{'TIME-SERIES.OF-THE-GOAL'|translate}}</label>
                                    </div>
                                </div>

                            </div>

                            <div class="row justify-content-center"
                                 style="height: 250px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                                 *ngIf="!sleepSelected && !loadingDashboard">
                                <div>
                                    <img class="text-center"
                                         src="../../../../assets/img/time-series/no-sleep.svg" width="95%">
                                </div>
                                <div>
                                    <label class="text-center">{{'ACTIVITY.SLEEP.UNAVAILABLE-DATA'|translate}}</label>
                                </div>
                            </div>

                            <div class="row justify-content-center"
                                 style="height: 264px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                                 *ngIf="loadingDashboard">
                                <spinner [message]="'SHARED.LOADING'|translate"></spinner>
                            </div>

                        </dashboard-card>
                    </div>
                    <!-- Steps -->
                    <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6"
                         style="padding: 0px 0px; padding-right: 7px; max-height: 332px"
                         (mouseenter)="stepEnterAndLeave(true)"
                         (mouseleave)="stepEnterAndLeave(false)">

                        <dashboard-card [title]="'TIME-SERIES.STEPS.TITLE'|translate">
                            <div class="row justify-content-center" *ngIf="!loadingDashboard">

                                <ngx-gauge
                                        [type]="'full'"
                                        [thick]="10"
                                        [min]="0"
                                        [max]="goal.steps"
                                        [cap]="'round'"
                                        [foregroundColor]="'#00a594'"
                                        [duration]="500"
                                        [value]="stepsValue">
                                    <ngx-gauge-value>
                                    </ngx-gauge-value>
                                </ngx-gauge>


                                <div class="fadeIn"
                                     style="position: absolute;display: flex;align-items: center;width:100%; height: 100%;justify-content: center;"
                                     *ngIf="!stepsHover">
                                    <img src="../../../../assets/img/time-series/steps-black.svg" width="30%"
                                         style="margin-bottom: 40%">
                                </div>
                                <div class="fadeIn"
                                     style="position: absolute;bottom:35%;width: 85%; display: flex;align-items: center;justify-content: center"
                                     *ngIf="stepsHover">
                                    <div style="display: block;padding: 0px 0px">
                                        <div class="text-center" style="padding: 0px 0px">
                                            <label style="font-size: 50px; margin: 0px 0px">
                                                {{Math.round((stepsValue * 100) / goal.steps)}}%
                                            </label>
                                        </div>
                                        <div class="text-center" style="padding: 0px 0px;">
                                            <label style="font-size: 20px;font-weight: normal;margin: 0px 0px">
                                                {{'TIME-SERIES.OF-THE-GOAL'|translate}}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div style="position: absolute;bottom:0%;width: 85%; display: flex; align-items: center; justify-content: center">
                                    <label style="font-size: 25px; font-weight: normal;">
                                        {{stepsValue}} de {{goal.steps ? goal.steps : 0}}
                                        <small>pas</small>
                                    </label>
                                </div>
                            </div>

                            <div class="row justify-content-center"
                                 style="height: 264px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                                 *ngIf="loadingDashboard">
                                <spinner [message]="'SHARED.LOADING'|translate"></spinner>
                            </div>

                        </dashboard-card>

                    </div>
                    <!-- Calories -->
                    <div class="col-sm-6 col-md-4 col-lg-4 col-xl-4"
                         style="padding: 0px 7px;min-height: 350px"
                         (mouseenter)="caloriesEnterAndLeave(true)"
                         (mouseleave)="caloriesEnterAndLeave(false)">

                        <dashboard-card [title]="'TIME-SERIES.CALORIES.TITLE'|translate">
                            <div class="row justify-content-center" *ngIf="!loadingDashboard">
                                <ngx-gauge [type]="'full'"
                                           [thick]="10"
                                           [min]="0"
                                           [cap]="'round'"
                                           [max]="goal.calories"
                                           [foregroundColor]="'#fba53e'"
                                           [duration]="200"
                                           [value]="caloriesValue"
                                           id="graphCalories">
                                    <ngx-gauge-value>
                                    </ngx-gauge-value>
                                </ngx-gauge>
                                <div class="fadeIn"
                                     style="position: absolute;display: flex;align-items: center;width:100%; height: 100%;justify-content: center;"
                                     *ngIf="!caloriesHover">
                                    <img src="../../../../assets/img/time-series/calories-black.svg" width="35%"
                                         style="margin-bottom: 60%">
                                </div>
                                <div class="fadeIn"
                                     style="position: absolute;bottom:38%;width: 85%; display: flex;align-items: center;justify-content: center"
                                     *ngIf="caloriesHover">
                                    <div style="display: block;padding: 0px 0px">
                                        <div class="text-center" style="padding: 0px 0px">
                                            <label style="font-size: 50px; margin: 0px 0px">
                                                {{Math.round((caloriesValue * 100) / goal.calories)}}%
                                            </label>
                                        </div>
                                        <div class="text-center" style="padding: 0px 0px;">
                                            <label style="font-size: 20px;font-weight: normal;margin: 0px 0px">
                                                {{'TIME-SERIES.OF-THE-GOAL'|translate}}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center"
                                     style="position: absolute;bottom:0%;width: 85%; display: flex; align-items: center; justify-content: center">
                                    <label style="font-size: 25px; font-weight: normal;">
                                        {{caloriesValue}} de {{goal.calories ? goal.calories : 0}}
                                        <small>calls</small>
                                    </label>
                                </div>
                            </div>

                            <div class="row justify-content-center"
                                 style="height: 264px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                                 *ngIf="loadingDashboard">
                                <spinner [message]="'SHARED.LOADING'|translate"></spinner>
                            </div>
                        </dashboard-card>

                    </div>
                    <!-- Active Minutes -->
                    <div class="col-sm-6 col-md-4 col-lg-4 col-xl-4"
                         style="padding:0px 0px; padding-right: 7px;"
                         (mouseenter)="activeMinutesEnterAndLeave(true)"
                         (mouseleave)="activeMinutesEnterAndLeave(false)">

                        <dashboard-card [title]="'TIME-SERIES.ACTIVE-MINUTES.TITLE'|translate">
                            <!--                                    <span style="position: absolute; right: 7px; top: 7px"-->
                            <!--                                          *ngIf="activeMinutesHover && !activeMinutesSettings"-->
                            <!--                                          title="Configurar meta..."-->
                            <!--                                          (click)="changeSettingsActiveMinutes()">-->
                            <!--                                        <i class="material-icons">settings</i>-->
                            <!--                                    </span>-->

                            <div class="row justify-content-center" *ngIf="!loadingDashboard">
                                <ngx-gauge [type]="'full'"
                                           [thick]="10"
                                           [min]="0"
                                           [cap]="'round'"
                                           [max]="goal.active_minutes"
                                           [foregroundColor]="'#A6F355'"
                                           [duration]="200"
                                           [value]="activeMinutesValue">
                                    <ngx-gauge-value>
                                    </ngx-gauge-value>
                                </ngx-gauge>
                                <div class="fadeIn"
                                     style="position: absolute;display: flex;align-items: center;width:100%; height: 100%;justify-content: center;"
                                     *ngIf="!activeMinutesHover">
                                    <img src="../../../../assets/img/time-series/active_minutes.svg" width="40%"
                                         style="margin-bottom: 60%">
                                </div>
                                <div class="fadeIn"
                                     style="position: absolute;bottom:38%;width: 85%; display: flex;align-items: center;justify-content: center"
                                     *ngIf="activeMinutesHover">
                                    <div style="display: block;padding: 0px 0px">
                                        <div class="text-center" style="padding: 0px 0px">
                                            <label style="font-size: 50px; margin: 0px 0px">
                                                {{Math.round((activeMinutesValue * 100) / goal.active_minutes)}}%
                                            </label>
                                        </div>
                                        <div class="text-center" style="padding: 0px 0px;">
                                            <label style="font-size: 20px;font-weight: normal;margin: 0px 0px">
                                                {{'TIME-SERIES.OF-THE-GOAL'|translate}}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div style="position: absolute;bottom:0%;width: 85%; display: flex; align-items: center; justify-content: center">
                                    <label style="font-size: 25px; font-weight: normal;max-width: 100%;">
                                        {{activeMinutesValue}} de {{goal.active_minutes ? goal.active_minutes : 0}}
                                        <small>min</small>
                                    </label>
                                </div>
                            </div>

                            <div class="row justify-content-center"
                                 style="height: 264px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                                 *ngIf="loadingDashboard">
                                <spinner [message]="'SHARED.LOADING'|translate"></spinner>
                            </div>

                        </dashboard-card>

                    </div>
                    <!-- Distance -->
                    <div class="col-sm-6 col-md-4 col-lg-4 col-xl-4"
                         style="padding:0px 0px; padding-right: 7px;"
                         (mouseenter)="distanceEnterAndLeave(true)"
                         (mouseleave)="distanceEnterAndLeave(false)">

                        <dashboard-card [title]="'TIME-SERIES.DISTANCE.TITLE'|translate">
                            <div class="row justify-content-center" *ngIf="!loadingDashboard">
                                <ngx-gauge
                                        [type]="'full'"
                                        [thick]="10"
                                        [min]="0"
                                        [cap]="'round'"
                                        [max]="goal.distance"
                                        [foregroundColor]="'#5FCCCB'"
                                        [duration]="200"
                                        [value]="distanceValue">
                                    <ngx-gauge-value>
                                    </ngx-gauge-value>
                                </ngx-gauge>
                                <div class="fadeIn"
                                     style="position: absolute;display: flex;align-items: center;width:100%; height: 100%;justify-content: center;"
                                     *ngIf="!distanceHover">
                                    <img src="../../../../assets/img/time-series/distance.svg" width="40%"
                                         style="margin-bottom: 60%">
                                </div>
                                <div class="fadeIn"
                                     style="position: absolute;bottom:38%;width: 85%; display: flex;align-items: center;justify-content: center"
                                     *ngIf="distanceHover">
                                    <div style="display: block;padding: 0px 0px">
                                        <div class="text-center" style="padding: 0px 0px">
                                            <label style="font-size: 50px; margin: 0px 0px">
                                                {{Math.round((distanceValue * 100) / goal.distance)}}%
                                            </label>
                                        </div>
                                        <div class="text-center" style="padding: 0px 0px;">
                                            <label style="font-size: 20px;font-weight: normal;margin: 0px 0px">
                                                {{'TIME-SERIES.OF-THE-GOAL'|translate}}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div style="position: absolute;bottom:0%;width: 85%; display: flex; align-items: center; justify-content: center">
                                    <label style="font-size: 25px; font-weight: normal;">
                                        {{distanceValue}} de {{goal.distance ? goal.distance : 0}}
                                        <small>m</small>
                                    </label>
                                </div>
                            </div>
                            <div class="row justify-content-center"
                                 style="height: 264px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                                 *ngIf="loadingDashboard">
                                <spinner [message]="'SHARED.LOADING'|translate"></spinner>
                            </div>
                        </dashboard-card>

                    </div>

                </div>

            </div>

            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12" style="padding-top:0px;">

                <dashboard-card [title]="measurementSelected | timeSeries | translate"
                                [urlAction]="['/app/patients/', patientId, measurementSelected]">

                    <div class="container-fluid">

                        <div class="row justify-content-end" *ngIf="!loadingDashboard">

                            <div class="col" style="max-width: 50px; padding: 0px 0px; margin: 0px 0px">
                                <mat-select class="form-control form-control-sm" style="border-radius: 10px"
                                            id="selectMeasurement"
                                            [(ngModel)]="measurementSelected">
                                    <mat-select-trigger>
                                        <mat-icon>
                                            <img [src]="'../../../../assets/img/time-series/'+measurementSelected+'.png'">
                                        </mat-icon>
                                    </mat-select-trigger>
                                    <mat-option *ngFor="let type of timeSeriesTypes" [value]="type"
                                                [title]="type | timeSeries | translate">
                                        <img [src]="'../../../../assets/img/time-series/'+type+'.png'">
                                    </mat-option>
                                </mat-select>

                            </div>

                            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12"
                                 style="padding: 0px 0px; margin: 0px 0px">
                                <view-timestamp [patientId]="patientId"
                                                [typeOfTimeSeries]="measurementSelected"></view-timestamp>
                            </div>
                        </div>

                        <div class="row justify-content-center"
                             style="height: 528px; padding: 0px 0px; display: flex; align-items: center; margin: auto"
                             *ngIf="loadingDashboard">
                            <spinner [message]="'SHARED.LOADING'|translate"></spinner>
                        </div>

                    </div>
                </dashboard-card>

            </div>

        </div>

    </div>

</div>

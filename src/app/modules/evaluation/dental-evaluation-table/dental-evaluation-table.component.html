<div class="input-group no-border">
  <input type="text" class="form-control" id="search" name="search" [(ngModel)]="search"
    placeholder="Pesquisar avaliação..." (keyup)="searchOnSubmit()">
  <button mat-raised-button type="button" class="btn btn-white btn-round btn-just-icon" (click)="searchOnSubmit()">
    <i class="material-icons">search</i>
    <div class="ripple-container"></div>
  </button>
</div>
<div class="table-responsive">
  <table class="table table-sm table-hover">
    <thead>
      <tr>
        <th>#</th>
        <th>Total de pacientes</th>
        <th>Data</th>
        <th>Arquivo CSV</th>
        <th>Arquivo XLSX</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let evaluation of listOfEvaluations; index as i">
        <td>{{getIndex(i)}}</td>
        <td>{{evaluation.total_patients}}</td>
        <td>{{evaluation.created_at | date}}</td>
        <td>
          <button class="btn btn-haniot-primary" (click)="download(evaluation.file_csv)">Download CSV</button>
        </td>
        <td>
          <button class="btn btn-haniot-primary" (click)="download(evaluation.file_xls)">Download XLS</button>
        </td>
        <td>
          <a class="nav-link" (click)="openModalConfirmation(evaluation.id)" title="Excluir avaliação...">
            <i class="material-icons">close</i>
          </a>
        </td>
      </tr>
    </tbody>
  </table>

</div>
<div class="row">
  <div class="col-sm-6 col-md-4 col-lg-4 col-xl-2">
    <button type="button" class="btn btn-haniot-primary" (click)="generateEvaluation()">
      Gerar Avaliação
      <i class="material-icons">cached</i>
    </button>
  </div>
  <div class="col-sm col-md col-lg col-xl">
    <mat-paginator [length]="length" [pageSize]="limit" [pageSizeOptions]="pageSizeOptions"
      (page)="clickPagination($event)">
    </mat-paginator>
  </div>
</div>


<modal-confirmation [message]="'Tem certeza que deseja remover avaliação?'" (confirmation)="removeEvaluation()"
  (noconfirmation)="closeModalComfimation()"></modal-confirmation>

<haniot-modal [modalId]="'dentalEvaluation'">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Avaliação odontológica</h5>
      <button type="button" class="close" aria-label="Close" (click)="closeModalDentalEvaluation()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="container">
        <div class="row" *ngIf="lastEvaluation">
          <div class="form-group col-sm-6 col-md-6 col-lg-3 col-xl-3">
            <label>Total de pacientes:</label>
            <p>{{lastEvaluation.total_patients}}</p>
          </div>
          <div class="form-group col-sm-6 col-md-6 col-lg-3 col-xl-3">
            <label>Data:</label>
            <p>{{lastEvaluation.created_at | date}}</p>
          </div>
          <div class="form-group col-sm-6 col-md-6 col-lg-3 col-xl-3">
            <label for="counseling">Arquivo CSV:</label>
            <a class="btn btn-haniot-primary" [href]="lastEvaluation.file_csv">Download CSV</a>
            <!-- <button class="btn btn-haniot-primary" (click)="download(lastEvaluation.file_csv)">Download CSV</button> -->
          </div>
          <div class="form-group col-sm-6 col-md-6 col-lg-3 col-xl-3">
            <label for="counseling">Arquivo XLS:</label>
            <button class="btn btn-haniot-primary" (click)="download(lastEvaluation.file_xls)">Download XLS</button>
          </div>
        </div>
      </div>
    </div>

  </div>
</haniot-modal>

<div id="generatingDentalEvaluantion" *ngIf="generatingEvaluantion">
  <div id="externa">

    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-body">
          <div class="container">
            <div class="row justify-content-center">
              <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12" id="loading">
                <img src="../../../../assets/img/loading.gif" alt=""> gerando avaliação odontológica...
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <!--Fundo preto do modal-->
  <div class="modal-backdrop show">
  </div>
</div>